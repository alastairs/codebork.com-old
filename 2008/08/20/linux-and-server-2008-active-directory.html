<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CodeBork | Linux and Server 2008 Active Directory</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="Linux and Server 2008 Active Directory">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://codebork.com/2008/08/20/linux-and-server-2008-active-directory.html">
  <meta property="og:description" content="">
  <meta property="og:site_name" content="CodeBork">
  <meta property="og:image" content="http://codebork.com/assets/og-image.jpg">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="http://codebork.com/2008/08/20/linux-and-server-2008-active-directory.html">
  <meta name="twitter:title" content="Linux and Server 2008 Active Directory">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="http://codebork.com/assets/og-image.jpg">

  <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png">
  <link href="http://codebork.comfeed.xml" type="application/rss+xml" rel="alternate" title="CodeBork Last 10 blog posts" />

  
    <link type="text/css" rel="stylesheet" href="/assets/light.css">
  
</head>

<body>
  <main role="main">
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav reveal">
  <a href="/" class="header-logo" title="CodeBork">CodeBork</a>
  <ul class="header-links">
    
      <li>
        <a href="http://twitter.com/alastairs" target="_blank" title="Twitter">
          <span class="icon icon-social-twitter"></span>
        </a>
      </li>
    
    
    
      <li>
        <a href="alastairs" target="_blank" title="GitHub">
          <span class="icon icon-social-github"></span>
        </a>
      </li>
    
    
    
    
    
      <li>
        <a href="mailto:codebork@alastairsmith.me.uk" target="_blank" title="Email">
          <span class="icon icon-at"></span>
        </a>
      </li>
    
    
      <li>
        <a href="/feed.xml" target="_blank" title="RSS">
          <span class="icon icon-social-rss"></span>
        </a>
      </li>
    
  </ul>
</nav>

        <article class="article reveal">
          <header class="article-header">
            <h1>Linux and Server 2008 Active Directory</h1>
            <p></p>
            <div class="article-list-footer">
              <span class="article-list-date">
                August 20, 2008
              </span>
              <span class="article-list-divider">-</span>
              <span class="article-list-minutes">
                
                
                  3 minute read
                
              </span>
              <span class="article-list-divider">-</span>
              <div class="article-list-tags">
                
              </div>
            </div>
          </header>

          <div class="article-content">
            <p>I’ve recently reconfigured my home network to utilise a Windows domain. As I’ve improved my home development environment, I’ve needed to make greater use of network shares and things, and running a mixed-OS environment as I do, I have inevitably run into some problems with credentials. <strong>This is the second post in a two-part series</strong>; <a href="http://www.alastairsmith.me.uk/science-and-technology/2008/08/20/my-experiences-server-2008.html" title="My experiences with Server 2008">the first post</a> describes my initial experiences configuring my domain, whilst this post will focus on getting Ubuntu and Fedora Core 7 talking to my domain.
<!--break-->
There are two subsystems that need to be configured to get Linux to connect to an Active Directory: Samba and Kerberos.  Most tutorials will teach you how to do this manually, and this method is fraught with semi-meaningful errors if you make a mistake (or seem to not have made a mistake).  These tutorials are ten-a-penny if you <a href="http://www.google.co.uk/search?q=Join+Linux+to+active+directory" title="Google search for &quot;Join Linux to active directory&quot;">search Google</a>, so I’m not going to replicate that information here, and not least because I didn’t manage to get it working this way.</p>

<p>What I’d like to do instead is draw your attention to a less well-known method that applies to all of the major distros and Mac OS X too: using <a href="http://www.likewisesoftware.com/products/likewise_open/">Likewise Open</a>.  I tried this on my Ubuntu server and it worked like a charm; ditto Fedora 7.  At this point, I’d like to credit <a href="http://bobbyallen.wordpress.com/" title="Bobby Allen's blog">Bobby Allen</a> for the invaluable help his <a href="http://bobbyallen.wordpress.com/2008/05/23/how-to-join-ubuntu-804-to-windows-active-directory-domain/" title="How to join Ubuntu 8.04 to Windows Active Directory (Domain)">post</a> provided.</p>

<p>The first step is to install Likewise Open.  This is simple enough on Ubuntu, Debian and other distros that use the apt-get update system; distros using RPM and yum (such as Fedora) will need to follow the link above to download, which requires registration.  It may be available from fink on Mac OS X; I don’t know as I haven’t tried.</p>

<p>Once installation is complete (which is very easy), you then just need to run the following command:
<code>
sudo domainjoin-cli join fqdn.of.your.domain Administrator
</code></p>

<p>On Fedora 7, the installer specified I had to supply the path to domainjoin-cli too:
<code>
sudo /usr/centeris/bin/domainjoin-cli join fqdn.of.your.domain Administrator
</code></p>

<p>Note that <code>fqdn.of.your.domain</code> is your domain itself, not the domain controller.  So for me, where the domain controller is called gandalf.middle-earth.co.uk, I typed middle-earth.co.uk here.  All being well, you should get a message stating that the domain was joined successfully.  If not, check the errors, tweak as necessary, and try again.  I had no errors on either system; it worked first time.</p>

<p>The next think you have to do (on Ubuntu) is to register Likewise Open with the daemon host and start the daemon:
<code>sudo update-rc.d likewise-open defaults
sudo /etc/init.d/likewise-open start</code></p>

<p>This should be completed as part of the installer on Fedora, etc.  Unfortunately, I haven’t found a way to confirm this yet.  Either way, you should be able to log on to your Linux host with the username DOMAIN\username, just as you would on Vista.  Note that you <em>really do have to add the DOMAIN</em>\, otherwise the Linux host will try to authenticate you against /etc/passwd or whatever other mechanism you were using before.  DOMAIN is the “pre-Windows 2000 domain” that you entered when setting up Active Directory, and is usually your domain name without the top-level domain suffixes (such as .com, .co.uk, etc.).</p>

<p>Finally, in order to get Windows Server 2008 to pick up the DNS suffix of the Linux host in the DHCP manager, I had to tweak the DHCP client configuration.  This was simple enough; simply add or edit the following line in your dhclient.conf file:
<code>
send "linux-hostname.fqdn.of.your.domain";
</code></p>

<p>Don’t forget to restart your network interface after making this change.</p>

<p>The location and name of the dhclient.conf file differs across distros: in Ubuntu it was at /etc/dhcp3/dhclient.conf; in Fedora 7 it was at /etc/dhclient-eth<em>n</em>.conf, where <em>n</em> matches the number of the network interface the config applies to (most likely 0).</p>

          </div>

          <div class="article-share">
            
            <a href="" title="Share on Twitter" onclick="window.open('https://twitter.com/home?status=Linux and Server 2008 Active Directory - http://codebork.com/2008/08/20/linux-and-server-2008-active-directory.html by @alastairs', 'newwindow', 'width=500, height=225'); return false;">
              <span class="icon icon-social-twitter"></span>
            </a>
            <a href="" title="Share on Facebook" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=http://codebork.com/2008/08/20/linux-and-server-2008-active-directory.html', 'newwindow', 'width=500, height=500'); return false;">
              <span class="icon icon-social-facebook"></span>
            </a>
            <a href="" title="Share on Google+" onclick="window.open('https://plus.google.com/share?url=http://codebork.com/2008/08/20/linux-and-server-2008-active-directory.html', 'newwindow', 'width=550, height=400'); return false;">
              <span class="icon icon-social-googleplus"></span>
            </a>
          </div>

          
        </article>
        <footer class="footer reveal">
  <p>
    Chalk is a high quality, completely customisable, performant and 100% free
    blog template for Jekyll built by
    <a href="/about" title="About me">Nielsen Ramon</a>. Download it <a href="https://github.com/nielsenramon/chalk" target="_blank" title="Download Chalk">here</a>.
  </p>
</footer>

      </div>
    </div>
  </main>
  <script type="text/javascript" src="/assets/vendor.js"></script>
<script type="text/javascript" src="/assets/application.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
<script>
  WebFont.load({
    google: {
      families: ['Cormorant Garamond:700', 'Lato:300,400,700']
    }
  });
</script>



</body>
</html>
